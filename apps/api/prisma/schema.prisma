generator client {
  provider = "prisma-client-js"
  output   = "../node_modules/.prisma/client"
}

datasource db {
  provider = "mysql"
  url      = env("MYSQL_DATABASE_URL")
}

model Account {
  id   String @id @default(uuid())
  name String

  users  User[]
  admins Admin[]

  safePoints        SafePoint[]
  emergencyContacts EmergencyContact[]

  @@map("accounts")
}

// Mobile App Users
enum UserStatus {
  ACTIVE
  BLOCKED
}

model User {
  id        String  @id @default(uuid())
  account   Account @relation(fields: [accountId], references: [id])
  accountId String  @map("account_id")

  email    String @unique
  name     String
  password String

  status UserStatus @default(ACTIVE)
  alerts Alert[]

  @@map("users")
}

model Alert {
  id String @id @default(uuid())

  user   User   @relation(fields: [userId], references: [id])
  userId String @map("user_id")

  lat Float
  lng Float

  createdAt DateTime @default(now()) @map("created_at")

  @@map("alerts")
}

model SafePoint {
  id        String  @id @default(uuid())
  account   Account @relation(fields: [accountId], references: [id])
  accountId String  @map("account_id")

  name    String
  address String
  lat     Float
  lng     Float
  type    String

  @@map("safe_points")
}

model EmergencyContact {
  id        String  @id @default(uuid())
  account   Account @relation(fields: [accountId], references: [id])
  accountId String  @map("account_id")

  name        String
  phone       String
  description String

  @@map("emergency_contacts")
}

// Web Panel Users
model Admin {
  id String @id @default(uuid())

  account   Account @relation(fields: [accountId], references: [id])
  accountId String  @map("account_id")

  email    String @unique
  password String

  @@map("admins")
}

model ActivityLog {
  id          String   @id @default(uuid())
  description String?
  createdAt   DateTime @default(now()) @map("created_at")

  @@map("activity_logs")
}
