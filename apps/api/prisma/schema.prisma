generator client {
  provider = "prisma-client-js"
  output   = "../node_modules/.prisma/client"
}

datasource db {
  provider = "mysql"
  url      = env("MYSQL_DATABASE_URL")
}

model Account {
  id   String @id @default(uuid())
  name String

  users            User[]
  safePoints       SafePoint[]
  EmergencyContact EmergencyContact[]

  @@map("accounts")
}

enum UserRoles {
  ADMIN
  MEMBER
}

enum UserStatus {
  ACTIVE
  BLOCKED
}

model User {
  id        String  @id @default(uuid())
  account   Account @relation(fields: [accountId], references: [id])
  accountId String  @map("account_id")

  email    String @unique
  name     String
  password String

  role   UserRoles  @default(MEMBER)
  status UserStatus @default(ACTIVE)
  alerts Alert[]

  @@map("users")
}

model Alert {
  id String @id @default(uuid())

  user   User   @relation(fields: [userId], references: [id])
  userId String @map("user_id")

  lat Float
  lng Float

  createdAt DateTime @default(now()) @map("created_at")

  @@map("alerts")
}

model SafePoint {
  id        String  @id @default(uuid())
  account   Account @relation(fields: [accountId], references: [id])
  accountId String  @map("account_id")

  name    String
  address String
  lat     Float
  lng     Float
  type    String

  @@map("safe_points")
}

model EmergencyContact {
  id        String  @id @default(uuid())
  account   Account @relation(fields: [accountId], references: [id])
  accountId String  @map("account_id")

  name        String
  phone       String
  description String

  @@map("emergency_contacts")
}
